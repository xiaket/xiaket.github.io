---
title:  "Pensieve: 1848"
date:   2018-12-02 20:09 +1100
ref:    pensieve-1848
---

### 所观所读

手机上读完了全职高手. 和大多数网络小说一样, 这个小说详略不得当, 一律追求主要人物形象塑造而忽略其他人. 两年前看v2上的介绍看过一遍后, 到这次重看前都还记得清一些细节. 从这个角度来说, 这个小说也有可取之处.

为了杀时间, 手机上开始读默克家庭诊疗手册. 这书厚实, 目前读了3%.

另外, 看了胡波的故事, 下一部书准备读他的大裂.

### 所玩

Diablo3的PL仍没到900, 大秘境也没到90.

### spectre.css

用[spectre.css](https://picturepan2.github.io/spectre/)这个轻量级的css框架重定义了网站的样式表. 部分颜色有些许变化, 而且代码块也取消了高亮显示. 想想, 博客上的代码做语法高亮也真的没特别大的必要, 就好比博客开放评论一样, 都是因为能实现这个功能而添加的功能, 而不属于核心的特性.

整体用spectre的感觉良好. 除了对于文件大小略有腹诽外没可以抱怨的地方了.

### 个人云方案

这个小项目终于告一段落了.

列举一下用Ansible playbook实现了的功能:

1. 树莓派初始化.
2. NFS服务供移动端上的[nPlayer](https://nplayer.com)播放视频.
3. SMB服务供电视上的VLC播放视频.
4. 穷人版的动态域名服务.
5. gogs提供私有git服务.
6. netatalk服务提供TimeMachine自动备份.
7. rsync客户端, 这个谈不上是服务了 不过在有了部分简单脚本, 我不用开笔记本一晚上从美国往家里下载东西了.
8. Webdav服务供家人访问娃的照片/视频们. 其中使用了Let's Encrypt的SSL证书. 另外在路由器上做了设置, 内网访问时会直接访问内网地址, 不会绕到公网去.

本周主要折腾的是SMB, 动态域名以及SSL.

SMB这个比较吐血. 电视上安卓系统里的VLC网络设备里会自动识别共享, 但是找不到手工添加的选项, 程序界面上也完全没有提到是否禁止了手工添加. 在网上用NFS, VLC做关键字能够搜出来一个新闻, 说一个旧版的VLC添加了NFS支持, 正在测试. 我想当然就以为NFS应该是支持的了. 但是电视上就是无法添加我共享出来的NFS存储. 直到后来我下载了iOS上的VLC客户端, 发现它不支持NFS, 只支持SMB, 才了解到这一点. 我另外还试用了安卓上的Kodi, 但是这货的中文显示有问题, 而且操作太过复杂, 我就老老实实架SMB服务了. 架服务本身真不值得提, 很简单.

家里签的网络提供商似乎什么端口都没有封, 我在路由器上把Mac上临时开的一个服务映射出去, 在我美国的VPS上测试, 发现80都可以直接访问. 动态域名的实现相对比较容易, 随便找一个服务拿到本地的外网IP, 然后将这个IP定时发给namesilo家的API就行了. namesilo家的API挺烂的, 这年头了还在用xml返回内容, 而且所有的API请求, 无论是否修改远程数据, 都用GET方法. 如果某个黑客能拿到其他人的API令牌, 往一个没访问量的小站上写一群带删除操作的链接, Google就会执行请求删除受害者的所有域名了.

SSL这个虽说之前搞过, 不过之前用的是DNS的校验方式, 这次用了更快捷的http校验. 原来很简单, 为了验证申请者对某个域名有管辖权, 证书发放方会要求申请者在站点的特定目录下放一个包含特殊内容的特殊文件. 证书发放方然后通过是否能访问到这个文件来认证申请者. 主要的障碍在于我用了几个容器来装各个部件的代码. 例如webdav的东西在一个容器, 而acmesh在另外一个容器, 所以处理共享需要写死一些东西. 不过, 说到底, 也没有什么能够拦住人的东西, 耐着性子写代码调试测试就完成了.

### 链接

* [nodejs的这个包的这个issue](https://github.com/dominictarr/event-stream/issues/116)值得读, 在攻击发生后, 各个人站在各个角度分表了自己的看法和意见. 每个人的立场不一样, 看法不一样, 态度也不一样. node的包管理有很多不足之处, 这不是这个系统第一次出问题, 在可以预见的未来, 也不会是最后一次. 我很同情这个包的原作者, 他自己已经没有使用这个包了, 也完全没有动力去维护它. 现在这个包由于被人植入恶意代码而导致不少人围攻这个原作者, 让人心寒.
* [Polygon上讲PS之父Ken的这篇长文](https://www.polygon.com/2018/11/26/18080492/playstation-history-ken-kutaragi-sony)中的有些故事很好玩. 比如Ken在每层楼都有一个工位, 比如炒自己老板的鱿鱼后跟自己的老板道歉什么的.
* [Gitlab跟踪这个NFS错误的故事](https://about.gitlab.com/2018/11/14/how-we-spent-two-weeks-hunting-an-nfs-bug/)也值得读. 故事很长, 我自己也没细读NFS内部实现那段, 了解大概就满足了. 我想说的是, 开源软件购买服务就是(理论上)买到了这样能够帮你把问题查到底的服务啊...
