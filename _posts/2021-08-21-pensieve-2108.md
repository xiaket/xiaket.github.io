---
title:  "Pensieve: 2108"
date:   2021-08-21 21:28
ref:    pensieve-2108
---


### 所观所读所玩

这个月没怎么看剧, 网上猎奇找了一个红都女皇看完了, 剪辑很乱, 不过一些视频的史料看得有点意思. 有点印象的有两部分, 一个是怀仁堂那一夜的回忆, 一个是外交部的高级职员讲述自己和江青打交道的经历. 

剧没怎么看, 这个月读书还算不错, 首先读完了解忧杂货店, 感觉还挺不错的, 结构挺精巧, 人物形象有点脸谱化不过也还过得去(因为人物很多), 最后的结局也很让人对世界充满希望; 另一本也是东野圭吾, 白金数据. 读的时候让我想起了Dan Brown的Digital Fortress, 这不是那种让我有重读欲的书, 而且对于技术的批评实在太过肤浅. 最后一个是网络小说史上很有名的诛仙, 不过在我看来很一般, 文笔幼稚情节弱智, 摇头. 当时那个年代真是时无英雄, 使竖子成名.

这个月游戏玩得不多, 不像前两个月那么疯狂. PS5上玩Untitle Goose Game, 带着娃一起调皮捣蛋, 娃玩得哈哈大笑. 自己在玩Cozy Grove, 没什么压力, 也没什么动力, 进度不快也就这样吧. 本还想再趁打折买点游戏, 不过最近娃嚷嚷着要玩Labo里面的玩具钢琴, 拿起NS一看, 里面还有不少游戏没怎么玩过呢, 于是就算了. 手机上倒是新玩了一个老游戏, 是几年前出的怪奇小店. 肝了几天, 玩完了剧情, 挑了困难模式玩到七百多天收了所有红名人物后就删了. 其他的成就知道怎么拿到, 不过实在没兴趣再去SL了.

### 离职和入职

这个月从一个Fintech离职, 换到Canva, 到现在入职刚一周.

在这个Fintech做了两年, 后面在同事的支持下也有了一定的话语权. 主要做了下面这些工作:

* 服务由Elastic Beanstalk到ECS迁移
* 理顺Buildkite构建
* 设计和实现了对Buildkite的加固
* 设计和实现AWS多账号的管理方式
* apigw的搭建

这些工作内容多少也有写blog介绍过, 再加上日常的打杂和维护, 回头看也学了不少东西, 做了不少事. 于是, 就这样告一段落吧.

刚进Canva, 各种环境和系统都还不太熟悉, 最基本的, 连AWS权限都还没拿到. 不过这儿的infra工程师比我在澳大利亚合作过的infra工程师加起来还多, 所以有点又回到了网易的感觉(而且比我入职网易时的SA也多). 另外, Canva面对的许多问题是我之前没有想过的, 比如在一个巨大的monorepo里面, `git status`都会需要很久, 导致我的[ps1命令](https://github.com/xiaket/etc/blob/master/go/ps1.go)会花几秒才能显示出来, 逼着我加了一段[防超时的逻辑](https://github.com/xiaket/etc/commit/de48344e184e448b0e382e221139756da931b7f6). 目前能感觉到的是文档相对比较全面, 而且人都很nice, 愿意互相帮助. 希望能够在Canva多做点事情有点成绩.


### 开源

上一个公司离职到Canva入职之间有6个工作日的空闲, 加上两个周末, 一共有10天, 本想着能够安心独自在家多写点[vapor](https://github.com/xiaket/vapor)的代码, 但是天不遂人愿, 因为疫情, 维州再次封城. 娃在家上学, 我也变成了专职陪娃. 不过趁着这个机会, 好歹也还是写了点儿代码, 包括Stack的deploy方法和delete方法, 包括各种hook, 和cfn-lint的集成, 包括测试. 回头来看, 也还是比较有成就感的. 做得最好玩的事情是拿到一个yaml/json的Cloudformation模板后, 能够生成出一个.py文件, 这部分逻辑本来想完全用jinja2实现, 后来发现Python代码部分比较麻烦, 所以部分换成用ast实现了. 这个过程中意外发现ast模块很容易用, 而且我还发现了一个3.9里新功能的bug, 第一次给Python提了[issue](https://bugs.python.org/issue44896). 提完issue看到有人开始干活忍不住想提建议时才又想起这是会影响到相当多人的Python, 于是闭上嘴由着core-dev去做决策了.

另外, 我还给老婆买了一台M1芯片的Macbook Air, 把她的一台11.6寸的Macbook Air抢过来当备用机, 为此, 写了一个脚本做机器的初始化. 在Canva发的笔记本上也跑了一遍, 没大问题, 代码可以在[这儿](https://github.com/xiaket/etc/blob/master/bootstrap/stage1.sh)找到. 在做机器初始化的时候本想用nix换掉Homebrew, 后来卡在我的ps1命令上, 根据查到的文档, 好像需要自己写一个recipe, 就灰溜溜地从入门到放弃了.
